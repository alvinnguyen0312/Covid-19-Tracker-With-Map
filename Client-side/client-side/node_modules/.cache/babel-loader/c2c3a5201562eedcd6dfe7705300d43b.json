{"ast":null,"code":"\"use strict\";\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar prop_types_1 = require(\"prop-types\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar convertListToArray_1 = __importDefault(require(\"../___utils/convertListToArray\"));\n\nvar uiFunctions_1 = require(\"./uiFunctions\");\n\nvar ScrollRenderer = function (props) {\n  var list = props.list,\n      renderItem = props.renderItem,\n      groupSeparator = props.groupSeparator;\n\n  var _a = react_1.useState({\n    renderList: [],\n    index: 0,\n    prevScrollPosition: 0\n  }),\n      render = _a[0],\n      setRender = _a[1];\n\n  var _b = react_1.useState(false),\n      mounted = _b[0],\n      setMounted = _b[1];\n\n  var dataList = convertListToArray_1.default(list);\n  var containerRef = react_1.createRef();\n  var adding = false;\n  var renderThisItem = uiFunctions_1.handleRenderItem(renderItem, uiFunctions_1.handleRenderGroupSeparator(groupSeparator));\n\n  var addItem = function (container, prevScrollPosition) {\n    if (prevScrollPosition === void 0) {\n      prevScrollPosition = render.prevScrollPosition;\n    }\n\n    if (!adding && render.index < dataList.length) {\n      adding = true; // @ts-ignore\n\n      var count = getComputedStyle(container).display === 'grid' ? 10 : 5;\n      setRender({\n        prevScrollPosition: prevScrollPosition,\n        renderList: __spreadArrays(render.renderList, dataList.slice(render.index, render.index + count)),\n        index: render.index + count\n      });\n    }\n  };\n\n  var onScroll = function (span) {\n    return function () {\n      var startingPoint = span.parentNode.offsetTop + span.parentNode.offsetHeight;\n      var anchorPos = span.offsetTop - span.parentNode.scrollTop;\n\n      if (anchorPos <= startingPoint + span.parentNode.offsetHeight * 2) {\n        requestAnimationFrame(function () {\n          return addItem(span.parentNode, span.parentNode.scrollTop);\n        });\n      }\n    };\n  };\n\n  react_1.useEffect(function () {\n    if (mounted) {\n      // reset list on list change\n      setRender({\n        renderList: [],\n        index: 0,\n        prevScrollPosition: 0\n      });\n    }\n  }, [list]);\n  react_1.useEffect(function () {\n    setMounted(true);\n    return function () {\n      if (containerRef.current) {\n        containerRef.current.parentNode.removeEventListener('scroll', onScroll, true);\n      }\n    };\n  }, []);\n  react_1.useLayoutEffect(function () {\n    var span = containerRef.current;\n    var container = null;\n    var handleScroll = onScroll(span);\n\n    if (span) {\n      container = span.parentNode; // populate double the container height of items\n\n      if (render.index === 0 || container.scrollHeight <= container.offsetHeight * 2) {\n        requestAnimationFrame(function () {\n          return addItem(container);\n        });\n      }\n\n      if (render.index > 0 && dataList.length === render.renderList.length) {\n        container.removeEventListener('scroll', handleScroll, true);\n      } else {\n        container.addEventListener('scroll', handleScroll, true);\n      }\n\n      adding = false;\n    }\n\n    return function () {\n      if (span) {\n        container.removeEventListener('scroll', handleScroll, true);\n      }\n    };\n  }, [render.index]);\n  return react_1.default.createElement(react_1.default.Fragment, null, render.renderList.map(renderThisItem), react_1.default.createElement(\"span\", {\n    ref: containerRef,\n    style: {\n      visibility: 'hidden',\n      height: 1\n    },\n    className: \"___scroll-renderer-anchor\"\n  }));\n};\n\nScrollRenderer.propTypes = {\n  list: prop_types_1.arrayOf(prop_types_1.any).isRequired,\n  renderItem: prop_types_1.func.isRequired,\n  groupSeparator: prop_types_1.oneOfType([prop_types_1.node, prop_types_1.func, prop_types_1.element])\n};\nScrollRenderer.defaultProps = {\n  groupSeparator: null\n};\nexports.default = ScrollRenderer;","map":{"version":3,"sources":["../../src/___subComponents/ScrollRenderer.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar prop_types_1 = require(\"prop-types\");\nvar react_1 = __importStar(require(\"react\"));\nvar convertListToArray_1 = __importDefault(require(\"../___utils/convertListToArray\"));\nvar uiFunctions_1 = require(\"./uiFunctions\");\nvar ScrollRenderer = function (props) {\n    var list = props.list, renderItem = props.renderItem, groupSeparator = props.groupSeparator;\n    var _a = react_1.useState({ renderList: [], index: 0, prevScrollPosition: 0 }), render = _a[0], setRender = _a[1];\n    var _b = react_1.useState(false), mounted = _b[0], setMounted = _b[1];\n    var dataList = convertListToArray_1.default(list);\n    var containerRef = react_1.createRef();\n    var adding = false;\n    var renderThisItem = uiFunctions_1.handleRenderItem(renderItem, uiFunctions_1.handleRenderGroupSeparator(groupSeparator));\n    var addItem = function (container, prevScrollPosition) {\n        if (prevScrollPosition === void 0) { prevScrollPosition = render.prevScrollPosition; }\n        if (!adding && render.index < dataList.length) {\n            adding = true;\n            // @ts-ignore\n            var count = getComputedStyle(container).display === 'grid' ? 10 : 5;\n            setRender({\n                prevScrollPosition: prevScrollPosition,\n                renderList: __spreadArrays(render.renderList, dataList.slice(render.index, render.index + count)),\n                index: render.index + count\n            });\n        }\n    };\n    var onScroll = function (span) { return function () {\n        var startingPoint = span.parentNode.offsetTop + span.parentNode.offsetHeight;\n        var anchorPos = span.offsetTop - span.parentNode.scrollTop;\n        if (anchorPos <= (startingPoint + (span.parentNode.offsetHeight * 2))) {\n            requestAnimationFrame(function () { return addItem(span.parentNode, span.parentNode.scrollTop); });\n        }\n    }; };\n    react_1.useEffect(function () {\n        if (mounted) { // reset list on list change\n            setRender({\n                renderList: [],\n                index: 0,\n                prevScrollPosition: 0\n            });\n        }\n    }, [list]);\n    react_1.useEffect(function () {\n        setMounted(true);\n        return function () {\n            if (containerRef.current) {\n                containerRef.current.parentNode.removeEventListener('scroll', onScroll, true);\n            }\n        };\n    }, []);\n    react_1.useLayoutEffect(function () {\n        var span = containerRef.current;\n        var container = null;\n        var handleScroll = onScroll(span);\n        if (span) {\n            container = span.parentNode;\n            // populate double the container height of items\n            if (render.index === 0 || container.scrollHeight <= (container.offsetHeight * 2)) {\n                requestAnimationFrame(function () { return addItem(container); });\n            }\n            if (render.index > 0 && dataList.length === render.renderList.length) {\n                container.removeEventListener('scroll', handleScroll, true);\n            }\n            else {\n                container.addEventListener('scroll', handleScroll, true);\n            }\n            adding = false;\n        }\n        return function () {\n            if (span) {\n                container.removeEventListener('scroll', handleScroll, true);\n            }\n        };\n    }, [render.index]);\n    return (react_1.default.createElement(react_1.default.Fragment, null,\n        render.renderList.map(renderThisItem),\n        react_1.default.createElement(\"span\", { ref: containerRef, style: { visibility: 'hidden', height: 1 }, className: \"___scroll-renderer-anchor\" })));\n};\nScrollRenderer.propTypes = {\n    list: prop_types_1.arrayOf(prop_types_1.any).isRequired,\n    renderItem: prop_types_1.func.isRequired,\n    groupSeparator: prop_types_1.oneOfType([prop_types_1.node, prop_types_1.func, prop_types_1.element])\n};\nScrollRenderer.defaultProps = {\n    groupSeparator: null\n};\nexports.default = ScrollRenderer;\n//# sourceMappingURL=ScrollRenderer.js.map"]},"metadata":{},"sourceType":"script"}